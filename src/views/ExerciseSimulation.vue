<template>
    <div id="base" class="body">

        <!-- Unnamed (组合) -->
        <div id="u974" class="ax_default" selectiongroup="课程名" data-left="20" data-top="412" data-width="1393"
             data-height="972">

            <!-- Unnamed (组合) -->
            <div id="u975" class="ax_default" data-left="248" data-top="412" data-width="1165" data-height="972">

                <!-- Unnamed (矩形) -->
                <div id="u976" class="ax_default box_1">
                    <div id="u976_div" class=""></div>
                    <div id="u976_text" class="text " style="">
                        <p></p>
                    </div>
                </div>
            </div>

            <!-- Unnamed (组合) -->
            <div id="u977" class="ax_default" data-left="20" data-top="412" data-width="229" data-height="972">

                <!-- Unnamed (矩形) -->
                <div id="u978" class="ax_default box_1">
                    <div id="u978_div" class=""></div>
                    <div id="u978_text" class="text " style="">
                        <p></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Unnamed (向右箭头按钮) -->
        <div id="u979" class="ax_default box_1" selectiongroup="课程名">
            <img id="u979_img" class="img " src="../images/模拟练习新/u979.svg"/>
            <div id="u979_text" class="text ">
                <p><span>▶&nbsp; 公司介绍</span></p>
            </div>
        </div>

        <!-- Unnamed (标题通栏) -->

        <!-- 灰色背景 (动态面板) -->
        <div id="u981" class="ax_default" data-label="灰色背景">
            <div id="u981_state0" class="panel_state" data-label="State1" style="">
                <div id="u981_state0_content" class="panel_state_content">
                </div>
            </div>
        </div>

        <!-- 线条 (动态面板) -->
        <div id="u982" class="ax_default" data-label="线条">
            <div id="u982_state0" class="panel_state" data-label="State1" style="">
                <div id="u982_state0_content" class="panel_state_content">
                </div>
            </div>
        </div>

        <!-- 页面标题 (矩形) -->
        <div id="u983" class="ax_default _默认样式" data-label="页面标题">
            <div id="u983_div" class=""></div>
            <div id="u983_text" class="text ">
                <p><span>页面标题</span></p>
            </div>
        </div>
        <div id="u980" style=""></div>

        <!-- Unnamed (版权信息) -->

        <!-- Unnamed (矩形) -->
        <div id="u985" class="ax_default _默认样式">
            <img id="u985_img" class="img " src="../images/登录窗口/u32.svg"/>
            <div id="u985_text" class="text ">
                <p><span>Copyright © http://www.chinatelecom.com.cn/, All Rights Reserved.</span></p>
                <p><span>电信服务人员培训成果考评系统</span></p>
            </div>
        </div>
        <div id="u984" style=""></div>

        <!-- 课程题目内容区 (动态面板) -->
        <div id="u986" class="ax_default" data-label="课程题目内容区">
            <div id="u986_state0" class="panel_state" data-label="1" style="">
                <div id="u986_state0_content" class="panel_state_content">

                    <!-- Unnamed (组合) -->
                    <div id="u987" class="ax_default" data-left="0" data-top="0" data-width="1102" data-height="77">

                        <!-- Unnamed (线段) -->
                        <div id="u988" class="ax_default box_1">
                            <img id="u988_img" class="img " src="../images/模拟练习新/u988.svg"/>
                            <div id="u988_text" class="text " style="">
                                <p></p>
                            </div>
                        </div>

                        <!-- Unnamed (圆形) -->
                        <div id="u989" class="ax_default box_1">
                            <img id="u989_img" class="img " src="../images/模拟练习新/u989.svg"/>
                            <div id="u989_text" class="text ">
                                <p><span>1</span></p>
                            </div>
                        </div>

                        <!-- Unnamed (矩形) -->
                        <div id="u990" class="ax_default box_1">
                            <div id="u990_div" class=""></div>
                            <div id="u990_text" class="text ">
                                <p><span>步骤1</span></p>
                            </div>
                        </div>

                        <!-- Unnamed (矩形) -->
                        <div id="u991" class="ax_default box_1">
                            <div id="u991_div" class=""></div>
                            <div id="u991_text" class="text ">
                                <p><span>步骤2</span></p>
                            </div>
                        </div>

                        <!-- Unnamed (矩形) -->
                        <div id="u992" class="ax_default box_1">
                            <div id="u992_div" class=""></div>
                            <div id="u992_text" class="text ">
                                <p><span>步骤3</span></p>
                            </div>
                        </div>

                        <!-- Unnamed (矩形) -->
                        <div id="u993" class="ax_default box_1">
                            <div id="u993_div" class=""></div>
                            <div id="u993_text" class="text ">
                                <p><span>步骤4</span></p>
                            </div>
                        </div>

                        <!-- Unnamed (圆形) -->
                        <div id="u994" class="ax_default box_1 selected">
                            <img id="u994_img" class="img " src="../images/模拟练习新/u994.svg"/>
                            <div id="u994_text" class="text ">
                                <p><span>2</span></p>
                            </div>
                        </div>

                        <!-- Unnamed (圆形) -->
                        <div id="u995" class="ax_default box_1">
                            <img id="u995_img" class="img " src="../images/模拟练习新/u994.svg"/>
                            <div id="u995_text" class="text ">
                                <p><span>4</span></p>
                            </div>
                        </div>

                        <!-- Unnamed (圆形) -->
                        <div id="u996" class="ax_default box_1 selected">
                            <img id="u996_img" class="img " src="../images/模拟练习新/u994.svg"/>
                            <div id="u996_text" class="text ">
                                <p><span>3</span></p>
                            </div>
                        </div>

                        <!-- Unnamed (圆形) -->
                        <div id="u997" class="ax_default box_1">
                            <img id="u997_img" class="img " src="../images/模拟练习新/u997.svg"/>
                            <div id="u997_text" class="text ">
                                <p><span>开始</span></p>
                            </div>
                        </div>

                        <!-- Unnamed (矩形) -->
                        <div id="u998" class="ax_default box_1">
                            <div id="u998_div" class=""></div>
                            <div id="u998_text" class="text ">
                                <p><span>步骤5</span></p>
                            </div>
                        </div>

                        <!-- Unnamed (圆形) -->
                        <div id="u999" class="ax_default box_1">
                            <img id="u999_img" class="img " src="../images/模拟练习新/u994.svg"/>
                            <div id="u999_text" class="text ">
                                <p><span>5</span></p>
                            </div>
                        </div>

                        <!-- Unnamed (圆形) -->
                        <div id="u1000" class="ax_default box_1">
                            <img id="u1000_img" class="img " src="../images/模拟练习新/u997.svg"/>
                            <div id="u1000_text" class="text ">
                                <p><span>结束</span></p>
                            </div>
                        </div>
                    </div>

                    <!-- Unnamed (组合) -->
                    <div id="u1001" class="ax_default" data-left="5" data-top="231" data-width="725" data-height="363">

                        <!-- Unnamed (组合) -->
                        <div id="u1002" class="ax_default" data-left="53" data-top="231" data-width="677"
                             data-height="363">

                            <!-- Unnamed (矩形) -->
                            <div id="u1003" class="ax_default _默认样式">
                                <div id="u1003_div" class=""></div>
                                <div id="u1003_text" class="text " style="">
                                    <p></p>
                                </div>
                            </div>
                        </div>

                        <!-- Unnamed (组合) -->
                        <div id="u1004" class="ax_default" data-left="5" data-top="231" data-width="48"
                             data-height="363">

                            <!-- Unnamed (矩形) -->
                            <div id="u1005" class="ax_default _默认样式">
                                <div id="u1005_div" class=""></div>
                                <div id="u1005_text" class="text " style="">
                                    <p></p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Unnamed (矩形) -->
                    <div id="u1006" class="ax_default _默认样式">
                        <div id="u1006_div" class=""></div>
                        <div id="u1006_text" class="text ">
                            <p><span>题目1：请听以下录音，并回答</span></p>
                        </div>
                    </div>

                    <!-- Unnamed (组合) -->
                    <div id="u1007" class="ax_default" data-left="87" data-top="349" data-width="103" data-height="45">

                        <!-- Unnamed (矩形) -->
                        <div id="u1008" class="ax_default _默认样式">
                            <div id="u1008_div" class="" style="visibility: hidden"></div>
                            <div id="u1008_text" class="text ">
                                <el-button :disabled="question==''" @click="playQuestion">
                                    {{!isPlayingQuestion?'播放':'取消'}}
                                </el-button>
                                <p class="question">{{question}}</p>
                            </div>
                        </div>
                    </div>

                    <!-- Unnamed (组合) -->
                    <div id="u1009" class="ax_default" data-left="751" data-top="231" data-width="380"
                         data-height="363">

                        <!-- Unnamed (组合) -->
                        <div id="u1010" class="ax_default" data-left="751" data-top="231" data-width="380"
                             data-height="363">

                            <!-- Unnamed (矩形) -->
                            <div id="u1011" class="ax_default _默认样式">
                                <div id="u1011_div" class=""></div>
                                <div id="u1011_text" class="text " style="">
                                    <p></p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Unnamed (组合) -->
                    <div id="u1012" class="ax_default" data-left="763" data-top="249" data-width="356" data-height="45">

                        <!-- Unnamed (矩形) -->
                        <div id="u1013" class="ax_default _默认样式">
                            <div id="u1013_div" class=""></div>
                            <div id="u1013_text" class="text ">
                                <p><span>答题区</span></p>
                            </div>
                        </div>
                    </div>

                    <!-- Unnamed (组合) -->
                    <div id="u1014" class="ax_default" data-left="5" data-top="614" data-width="1126" data-height="217">

                        <!-- Unnamed (组合) -->
                        <div id="u1015" class="ax_default" data-left="5" data-top="614" data-width="1126"
                             data-height="217">

                            <!-- Unnamed (矩形) -->
                            <div id="u1016" class="ax_default _默认样式">
                                <div id="u1016_div" class=""></div>
                                <div id="u1016_text" class="text " style="">
                                    <p></p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Unnamed (组合) -->
                    <div id="u1017" class="ax_default" data-left="41" data-top="629" data-width="1055" data-height="39">

                        <!-- Unnamed (矩形) -->
                        <div id="u1018" class="ax_default _默认样式">
                            <div id="u1018_div" class=""></div>
                            <div id="u1018_text" class="text ">
                                <p><span>判定区</span></p>
                            </div>
                        </div>
                    </div>

                    <!-- Unnamed (矩形) -->
                    <div id="u1019" class="ax_default _默认样式" @click="getQuestion">
                        <div id="u1019_div"></div>
                        <div id="u1019_text" class="text ">
                            <p><span>重新抽题</span></p>
                        </div>
                    </div>

                    <!-- Unnamed (组合) -->
                    <div id="u1020" class="ax_default" data-left="5" data-top="92" data-width="1126" data-height="124">

                        <!-- Unnamed (矩形) -->
                        <div id="u1021" class="ax_default shape">
                            <div id="u1021_div" class=""></div>
                            <div id="u1021_text" class="text ">
                                <p style="font-size:16px;line-height:28px;"><span
                                        style="font-family:'PingFang SC ', 'PingFang SC', sans-serif;color:rgba(0, 0, 0, 0.647058823529412);">步骤1：开始接到商机话务</span>
                                </p>
                                <p style="font-size:14px;line-height:26px;"><span
                                        style="font-family:'PingFang SC ', 'PingFang SC', sans-serif;color:rgba(0, 0, 0, 0.427450980392157);">本步骤要求时长5分钟以内，以开始录音和结束录音的时间计算！</span>
                                </p>
                                <p style="font-size:14px;line-height:26px;"><span
                                        style="font-family:'PingFang SC ', 'PingFang SC', sans-serif;color:#3399FF;">请点击播放按钮，听录音，播放完成后，点击开始录音进行回答。</span>
                                </p>
                                <p style="font-size:14px;line-height:26px;"><span
                                        style="font-family:'Microsoft Tai Le', sans-serif;color:#1890FF;"><br></span>
                                </p>
                            </div>
                        </div>

                        <!-- Unnamed (图片 ) -->
                        <div id="u1022" class="ax_default image1">
                            <img id="u1022_img" class="img " src="../images/模拟练习新/u1022.png"/>
                            <div id="u1022_text" class="text ">
                                <p></p>
                            </div>
                        </div>
                    </div>

                    <!-- Unnamed (矩形) -->
                    <div id="u1023" class="ax_default _文本段落">
                        <div id="u1023_div" class=""></div>
                        <div id="u1023_text" class="text ">
                            <p><span>开始接到商机话务</span></p>
                        </div>
                    </div>

                    <!-- Unnamed (组合) -->
                    <div id="u1024" class="ax_default" data-left="763" data-top="311" data-width="103" data-height="45">

                        <!-- Unnamed (矩形) -->
                        <div id="u1025" class="ax_default _默认样式" style="z-index: 99">
                            <div id="u1025_div" class=""></div>
                            <div id="u1025_text" class="text ">
                                <el-button @click="switchRecorderBoard">开始录音</el-button>
                            </div>
                        </div>
                    </div>

                    <!-- 录音结束 (动态面板) -->
                    <div id="u1026" class="ax_default" data-label="录音结束" style="visibility: visible">
                        <div id="u1026_state0" class="panel_state" data-label="State1">
                            <div id="u1026_state0_content" class="panel_state_content">

                                <!-- Unnamed (组合) -->
                                <div id="u1027" class="ax_default" data-left="121" data-top="0" data-width="103"
                                     data-height="45">
                                    <!-- Unnamed (矩形) -->
                                    <div id="u1028" class="ax_default _默认样式" style="visibility: hidden">
                                        <div id="u1028_div" class=""></div>
                                        <div id="u1028_text" class="text ">
                                            <el-button>重新录音</el-button>
                                        </div>
                                    </div>
                                </div>

                                <!-- Unnamed (矩形) -->
                                <div id="u1029" class="ax_default _文本段落">
                                    <div id="u1029_div" class=""></div>
                                    <div id="u1029_text" class="text ">
                                        <p v-show="hasRecord"><span>已完成录音回答</span></p>
                                    </div>
                                </div>

                                <!-- Unnamed (组合) -->
                                <div id="u1030" class="ax_default" data-left="121" data-top="79" data-width="103"
                                     data-height="45">

                                    <!-- Unnamed (矩形) -->
                                    <div id="u1031" class="ax_default _默认样式">
                                        <div id="u1031_div" class=""></div>
                                        <div id="u1031_text" class="text ">
                                            <el-button :disabled="!hasRecord" @click="replayRecording">回答录音播放
                                            </el-button>
                                        </div>
                                        <video v-show="showPlayer" class='videoplayer' controls="controls" ref="recorderPlayer"
                                               type="audio/wav"></video>
                                    </div>
                                </div>

                                <!-- Unnamed (矩形) -->
                                <div id="u1032" class="ax_default _默认样式">
                                    <div id="u1032_div" style="background: none"></div>
                                    <div id="u1032_text" class="text ">
                                        <el-button type="primary" size="large" :disabled="!hasRecord || !allowed_post"
                                                   @click="uploadRecording">提交判定
                                        </el-button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Unnamed (矩形) -->
                    <div id="u1033" class="ax_default _文本段落">
                        <div id="u1033_div" class=""></div>
                        <div id="u1033_text" class="text ">
                            <p></p>
                        </div>
                    </div>

                    <!-- 判定结果 (动态面板) -->
                    <div id="u1034" style="visibility: visible" class="ax_default" data-label="判定结果"
                    >
                        <div id="u1034_state0" class="panel_state" data-label="结果运算" style="">
                            <div id="u1034_state0_content" class="panel_state_content">

                                <!-- Unnamed (矩形) -->
                                <div id="u1035" class="ax_default _文本段落">
                                    <div id="u1035_div" class=""></div>
                                    <div id="u1035_text" class="text " v-show="submitted&&judgeResult==undefined">
                                        <p><span>======》》结果判定中，请稍后《《======</span></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="u1034_state1" class="panel_state" data-label="结果显示" style="">
                            <div id="u1034_state1_content" class="panel_state_content">

                                <!-- Unnamed (矩形) -->
                                <div id="u1036" class="ax_default _一级标题" style="visibility: hidden">
                                    <div id="u1036_div" class=""></div>
                                    <div id="u1036_text" class="text ">
                                        <p><span>05:05</span></p>
                                    </div>
                                </div>

                                <!-- Unnamed (矩形) -->
                                <div id="u1037" class="ax_default _默认样式">
                                    <div id="u1037_div" class=""></div>
                                    <div id="u1037_text" class="text " v-show="submitted">
                                        <p class="judge-text">当前用时:{{formatTime(stopTime)}}</p>
                                    </div>
                                </div>

                                <!-- Unnamed (矩形) -->
                                <div id="u1038" class="ax_default _一级标题" style="visibility: hidden">
                                    <div id="u1038_div" class=""></div>
                                    <div id="u1038_text" class="text ">
                                        <p><span>05:00</span></p>
                                    </div>
                                </div>

                                <!-- Unnamed (矩形) -->
                                <div id="u1039" class="ax_default _默认样式">
                                    <div id="u1039_div" class=""></div>
                                    <div id="u1039_text" class="text " v-show="submitted">
                                        <!--                                        <p><span></span></p>-->
                                        <p class="judge-text">要求时限：5:00</p>
                                    </div>
                                </div>

                                <!-- Unnamed (矩形) -->
                                <div id="u1040" class="ax_default _文本段落" style="visibility: hidden">
                                    <div id="u1040_div" class=""></div>
                                    <div id="u1040_text" class="text ">
                                        <p><span>确认用户地址</span></p>
                                    </div>
                                </div>

                                <!-- Unnamed (矩形) -->
                                <div id="u1041" class="ax_default _文本段落">
                                    <div id="u1041_div" class=""></div>
                                    <div id="u1041_text" class="text " v-show="submitted">
                                        <p><span>本次练习，您回答 </span>
                                            <span class="judge-text">{{judgeResult==undefined?'待提交':judgeResult}}</span>
                                        </p>
                                    </div>
                                </div>

                                <!-- Unnamed (矩形) -->
                                <div id="u1042" class="ax_default box_2" style="visibility: hidden">
                                    <div id="u1042_div" class=""></div>
                                    <div id="u1042_text" class="text ">
                                        <p><span>60分</span></p>
                                    </div>
                                </div>

                                <!-- Unnamed (矩形) -->
                                <div id="u1043" class="ax_default _文本段落" style="visibility: hidden">
                                    <div id="u1043_div" class=""></div>
                                    <div id="u1043_text" class="text ">
                                        <p><span>本步骤综合得分</span></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <div class="recorder-board" v-show="boardShow">
            <div class="board-top">
                <span>录音</span>
                <i class="iconfont icon-close" @click="boardShow=false"></i>
            </div>
            <div class="board-middle">
                <div class="recorder-bar">
                    <i v-show="!isRecording" class="iconfont icon-24gf-play" @click="startRecording"></i>
                    <i v-show="isRecording" class="iconfont icon-sound"></i>
                    <el-progress class="progress" :show-text="false"
                                 :stroke-width="10" :percentage="parseInt(recordingTime*100/limitTime)"
                                 color="#2E70ED">
                    </el-progress>
                    <span>{{recorderTimeText}}/{{parseInt(limitTime/60)}}:00</span>
                </div>
            </div>
            <div class="board-foot">
                <el-button class="button" :disabled="isRecording" @click="startRecording">开始</el-button>
                <el-button :disabled="!isRecording" class="button" @click="restartRecording">重新开始</el-button>
                <el-button :disabled="!isRecording" class="button" :type="isRecording?'danger':''"
                           @click="stopRecording">结束
                </el-button>
                <el-button :disabled="stopTime==0" class="button" type="primary" @click="saveRecording">保存</el-button>
            </div>
        </div>


        <!-- Unnamed (矩形) -->
        <div id="u1272" class="ax_default _默认样式">
            <div id="u1272_div" class=""></div>
            <div id="u1272_text" class="text " style="">
                <p></p>
            </div>
        </div>

        <!-- Unnamed (矩形) -->
        <div id="u1273" class="ax_default _默认样式">
            <div id="u1273_div" class=""></div>
            <div id="u1273_text" class="text " style="">
                <p></p>
            </div>
        </div>

        <!-- Unnamed (表格) -->
        <div id="u1274" class="ax_default _表格">

            <!-- Unnamed (单元格) -->
            <div id="u1275" class="ax_default _默认样式">
                <img id="u1275_img" class="img " src="../images/正式考试/u488.png"/>
                <div id="u1275_text" class="text ">
                    <p><span>编号</span></p>
                </div>
            </div>

            <!-- Unnamed (单元格) -->
            <div id="u1276" class="ax_default _默认样式">
                <img id="u1276_img" class="img " src="../images/模拟练习新/u1276.png"/>
                <div id="u1276_text" class="text ">
                    <p><span>8447466</span></p>
                </div>
            </div>

            <!-- Unnamed (单元格) -->
            <div id="u1277" class="ax_default _默认样式">
                <img id="u1277_img" class="img " src="../images/模拟练习新/u1277.png"/>
                <div id="u1277_text" class="text ">
                    <p><span>部门</span></p>
                </div>
            </div>

            <!-- Unnamed (单元格) -->
            <div id="u1278" class="ax_default _默认样式">
                <img id="u1278_img" class="img " src="../images/模拟练习新/u1278.png"/>
                <div id="u1278_text" class="text ">
                    <p><span>西安电信公司</span></p>
                </div>
            </div>

            <!-- Unnamed (单元格) -->
            <div id="u1279" class="ax_default _默认样式">
                <img id="u1279_img" class="img " src="../images/正式考试/u488.png"/>
                <div id="u1279_text" class="text ">
                    <p><span>手机号码</span></p>
                </div>
            </div>

            <!-- Unnamed (单元格) -->
            <div id="u1280" class="ax_default _默认样式">
                <img id="u1280_img" class="img " src="../images/模拟练习新/u1276.png"/>
                <div id="u1280_text" class="text ">
                    <p><span>18888888888</span></p>
                </div>
            </div>

            <!-- Unnamed (单元格) -->
            <div id="u1281" class="ax_default _默认样式">
                <img id="u1281_img" class="img " src="../images/模拟练习新/u1277.png"/>
                <div id="u1281_text" class="text " style="">
                    <p></p>
                </div>
            </div>

            <!-- Unnamed (单元格) -->
            <div id="u1282" class="ax_default _默认样式">
                <img id="u1282_img" class="img " src="../images/模拟练习新/u1278.png"/>
                <div id="u1282_text" class="text " style="">
                    <p></p>
                </div>
            </div>

            <!-- Unnamed (单元格) -->
            <div id="u1283" class="ax_default _默认样式">
                <img id="u1283_img" class="img " src="../images/正式考试/u488.png"/>
                <div id="u1283_text" class="text ">
                    <p><span>性别</span></p>
                </div>
            </div>

            <!-- Unnamed (单元格) -->
            <div id="u1284" class="ax_default _默认样式">
                <img id="u1284_img" class="img " src="../images/模拟练习新/u1276.png"/>
                <div id="u1284_text" class="text ">
                    <p><span>男</span></p>
                </div>
            </div>

            <!-- Unnamed (单元格) -->
            <div id="u1285" class="ax_default _默认样式">
                <img id="u1285_img" class="img " src="../images/模拟练习新/u1277.png"/>
                <div id="u1285_text" class="text " style="">
                    <p></p>
                </div>
            </div>

            <!-- Unnamed (单元格) -->
            <div id="u1286" class="ax_default _默认样式">
                <img id="u1286_img" class="img " src="../images/模拟练习新/u1278.png"/>
                <div id="u1286_text" class="text " style="">
                    <p></p>
                </div>
            </div>

            <!-- Unnamed (单元格) -->
            <div id="u1287" class="ax_default _默认样式">
                <img id="u1287_img" class="img " src="../images/正式考试/u488.png"/>
                <div id="u1287_text" class="text ">
                    <p><span>生日</span></p>
                </div>
            </div>

            <!-- Unnamed (单元格) -->
            <div id="u1288" class="ax_default _默认样式">
                <img id="u1288_img" class="img " src="../images/模拟练习新/u1276.png"/>
                <div id="u1288_text" class="text ">
                    <p><span>1984年6月22日</span></p>
                </div>
            </div>

            <!-- Unnamed (单元格) -->
            <div id="u1289" class="ax_default _默认样式">
                <img id="u1289_img" class="img " src="../images/模拟练习新/u1277.png"/>
                <div id="u1289_text" class="text " style="">
                    <p></p>
                </div>
            </div>

            <!-- Unnamed (单元格) -->
            <div id="u1290" class="ax_default _默认样式">
                <img id="u1290_img" class="img " src="../images/模拟练习新/u1278.png"/>
                <div id="u1290_text" class="text " style="">
                    <p></p>
                </div>
            </div>

            <!-- Unnamed (单元格) -->
            <div id="u1291" class="ax_default _默认样式">
                <img id="u1291_img" class="img " src="../images/正式考试/u504.png"/>
                <div id="u1291_text" class="text ">
                    <p><span>城市</span></p>
                </div>
            </div>

            <!-- Unnamed (单元格) -->
            <div id="u1292" class="ax_default _默认样式">
                <img id="u1292_img" class="img " src="../images/模拟练习新/u1292.png"/>
                <div id="u1292_text" class="text ">
                    <p><span>广东省深圳市</span></p>
                </div>
            </div>

            <!-- Unnamed (单元格) -->
            <div id="u1293" class="ax_default _默认样式">
                <img id="u1293_img" class="img " src="../images/模拟练习新/u1293.png"/>
                <div id="u1293_text" class="text " style="">
                    <p></p>
                </div>
            </div>

            <!-- Unnamed (单元格) -->
            <div id="u1294" class="ax_default _默认样式">
                <img id="u1294_img" class="img " src="../images/模拟练习新/u1294.png"/>
                <div id="u1294_text" class="text " style="">
                    <p></p>
                </div>
            </div>
        </div>

        <!-- Unnamed (矩形) -->
        <div id="u1295" class="ax_default _默认样式">
            <div id="u1295_div" class=""></div>
            <div id="u1295_text" class="text ">
                <p><span>张某某</span></p>
            </div>
        </div>

        <!-- Unnamed (矩形) -->
        <div id="u1296" class="ax_default _默认样式">
            <img id="u1296_img" class="img " src="../images/正式考试/u523.svg"/>
            <div id="u1296_text" class="text ">
                <p><span>客服代表岗位模拟训练</span></p>
            </div>
        </div>

        <!-- Unnamed (形状) -->
        <div id="u1297" class="ax_default _默认样式">
            <img id="u1297_img" class="img " src="../images/正式考试/u524.svg"/>
            <div id="u1297_text" class="text " style="">
                <p></p>
            </div>
        </div>

        <!-- Unnamed (向右箭头按钮) -->
        <div id="u1298" class="ax_default box_1" selectiongroup="课程名">
            <img id="u1298_img" class="img " src="../images/模拟练习新/u979.svg"/>
            <div id="u1298_text" class="text ">
                <p><span>▶&nbsp; 承接来话流程</span></p>
            </div>
        </div>

        <!-- Unnamed (向右箭头按钮) -->
        <div id="u1299" class="ax_default box_1" selectiongroup="课程名">
            <img id="u1299_img" class="img " src="../images/模拟练习新/u979.svg"/>
            <div id="u1299_text" class="text ">
                <p><span>▶&nbsp; 确保服务质量</span></p>
            </div>
        </div>

        <!-- Unnamed (向右箭头按钮) -->
        <div id="u1300" class="ax_default box_1 selected" selectiongroup="课程名">
            <img id="u1300_img" class="img " src="../images/模拟练习新/u979_selected.svg"/>
            <div id="u1300_text" class="text ">
                <p><span>▶&nbsp; 开展营销工作</span></p>
            </div>
        </div>

        <!-- Unnamed (向右箭头按钮) -->
        <div id="u1301" class="ax_default box_1" selectiongroup="课程名">
            <img id="u1301_img" class="img " src="../images/模拟练习新/u979.svg"/>
            <div id="u1301_text" class="text ">
                <p><span>▶&nbsp; 支持流程优化</span></p>
            </div>
        </div>

        <!-- Unnamed (向右箭头按钮) -->
        <div id="u1302" class="ax_default box_1" selectiongroup="课程名">
            <img id="u1302_img" class="img " src="../images/模拟练习新/u979.svg"/>
            <div id="u1302_text" class="text ">
                <p><span>▶&nbsp; 提升个人能力及心态</span></p>
            </div>
        </div>

        <!-- Unnamed (矩形) -->
        <div id="u1303" class="ax_default _默认样式">
            <div id="u1303_div" class=""></div>
            <div id="u1303_text" class="text ">
                <p><span>下一步</span></p>
            </div>
        </div>
        7

        <!-- Unnamed (矩形) -->
        <div id="u1304" class="ax_default _默认样式">
            <img id="u1304_img" class="img " src="../images/模拟练习新/u1304.svg"/>
            <div id="u1304_text" class="text ">
                <p><span>课程切换</span></p>
            </div>
        </div>

        <!-- 录音播放框 (动态面板) -->
        <div id="u1305" class="ax_default" data-label="录音播放框">
            <div id="u1305_state0" class="panel_state" data-label="添加部门" style="">
                <div id="u1305_state0_content" class="panel_state_content">

                    <!-- Unnamed (矩形) -->
                    <div id="u1306" class="ax_default box_1">
                        <div id="u1306_div" class=""></div>
                        <div id="u1306_text" class="text ">
                            <p></p>
                        </div>
                    </div>

                    <!-- Unnamed (矩形) -->
                    <div id="u1307" class="ax_default box_1">
                        <div id="u1307_div" class=""></div>
                        <div id="u1307_text" class="text " style="">
                            <p></p>
                        </div>
                    </div>

                    <!-- Unnamed (矩形) -->
                    <div id="u1308" class="ax_default box_1">
                        <div id="u1308_div" class=""></div>
                        <div id="u1308_text" class="text ">
                            <p><span>录音播放</span></p>
                        </div>
                    </div>

                    <!-- Unnamed (形状) -->
                    <div id="u1309" class="ax_default box_1">
                        <img id="u1309_img" class="img " src="../images/模拟练习新/u1309.svg"/>
                        <div id="u1309_text" class="text " style="">
                            <p></p>
                        </div>
                    </div>

                    <!-- Unnamed (组合) -->
                    <div id="u1310" class="ax_default" data-left="120" data-top="242" data-width="299" data-height="35">

                        <!-- Unnamed (组合) -->
                        <div id="u1311" class="ax_default" data-left="120" data-top="242" data-width="299"
                             data-height="35">

                            <!-- Unnamed (矩形) -->
                            <div id="u1312" class="ax_default box_1">
                                <div id="u1312_div" class=""></div>
                                <div id="u1312_text" class="text ">
                                    <p><span>取消</span></p>
                                </div>
                            </div>

                            <!-- Unnamed (矩形) -->
                            <div id="u1313" class="ax_default box_1">
                                <div id="u1313_div" class=""></div>
                                <div id="u1313_text" class="text ">
                                    <p><span>确定</span></p>
                                </div>
                            </div>

                            <!-- Unnamed (矩形) -->
                            <div id="u1314" class="ax_default box_1">
                                <div id="u1314_div" class=""></div>
                                <div id="u1314_text" class="text ">
                                    <p><span>重听</span></p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Unnamed (图片 ) -->
                    <div id="u1315" class="ax_default _图片_">
                        <img id="u1315_img" class="img " src="../images/模拟练习新/u1315.png"/>
                        <div id="u1315_text" class="text " style="">
                            <p></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 录音对话框 (动态面板) -->
        <div id="u1316" class="ax_default " data-label="录音对话框"
             style="">
            <div id="u1316_state0" class="panel_state" data-label="添加部门" style="">
                <div id="u1316_state0_content" class="panel_state_content">

                    <!-- Unnamed (矩形) -->
                    <div id="u1317" class="ax_default box_1">
                        <div id="u1317_div" class=""></div>
                        <div id="u1317_text" class="text " style="">
                            <p></p>
                        </div>
                    </div>

                    <!-- Unnamed (矩形) -->
                    <div id="u1318" class="ax_default box_1">
                        <div id="u1318_div" class=""></div>
                        <div id="u1318_text" class="text " style="">
                            <p></p>
                        </div>
                    </div>

                    <!-- Unnamed (矩形) -->
                    <div id="u1319" class="ax_default box_1">
                        <div id="u1319_div" class=""></div>
                        <div id="u1319_text" class="text ">
                            <p><span>录音</span></p>
                        </div>
                    </div>

                    <!-- Unnamed (形状) -->
                    <div id="u1320" class="ax_default box_1">
                        <img id="u1320_img" class="img " src="../images/模拟练习新/u1309.svg"/>
                        <div id="u1320_text" class="text " style="">
                            <p></p>
                        </div>
                    </div>

                    <!-- Unnamed (组合) -->
                    <div id="u1321" class="ax_default" data-left="58" data-top="242" data-width="378" data-height="35">

                        <!-- Unnamed (组合) -->
                        <div id="u1322" class="ax_default" data-left="58" data-top="242" data-width="378"
                             data-height="35">

                            <!-- Unnamed (矩形) -->
                            <div id="u1323" class="ax_default box_1">
                                <div id="u1323_div" class=""></div>
                                <div id="u1323_text" class="text ">
                                    <p><span>开始</span></p>
                                </div>
                            </div>

                            <!-- Unnamed (矩形) -->
                            <div id="u1324" class="ax_default box_1">
                                <div id="u1324_div" class=""></div>
                                <div id="u1324_text" class="text ">
                                    <p><span>保存</span></p>
                                </div>
                            </div>

                            <!-- Unnamed (矩形) -->
                            <div id="u1325" class="ax_default box_1">
                                <div id="u1325_div" class=""></div>
                                <div id="u1325_text" class="text ">
                                    <p><span>结束</span></p>
                                </div>
                            </div>

                            <!-- Unnamed (矩形) -->
                            <div id="u1326" class="ax_default box_1">
                                <div id="u1326_div" class=""></div>
                                <div id="u1326_text" class="text ">
                                    <p><span>重新开始</span></p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Unnamed (图片 ) -->
                    <div id="u1327" class="ax_default _图片_">
                        <img id="u1327_img" class="img " src="../images/模拟练习新/u1315.png"/>
                        <div id="u1327_text" class="text " style="">
                            <p></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Unnamed (矩形) -->
        <div id="u1328" class="ax_default _默认样式">
            <div id="u1328_div" class=""></div>
            <div id="u1328_text" class="text ">
                <p><span>再次练习</span></p>
            </div>
        </div>

        <!-- Unnamed (矩形) -->
        <div id="u1329" class="ax_default box_1">
            <div id="u1329_div" class=""></div>
            <div id="u1329_text" class="text ">
                <p style="font-size:28px;"><span style="color:#F04844;">60</span></p>
                <p style="font-size:14px;"><span style="color:#666666;">综合得分</span></p>
            </div>
        </div>

        <!-- Unnamed (矩形) -->
        <div id="u1330" class="ax_default box_1">
            <div id="u1330_div" class=""></div>
            <div id="u1330_text" class="text ">
                <p style="font-size:28px;"><span style="color:#F04844;">200</span></p>
                <p style="font-size:14px;"><span style="color:#666666;">完成训练次数</span></p>
            </div>
        </div>
    </div>
</template>

<script>
    import Recorder from "@/utils/recorder/recorder";
    var audioContext;
    var recorder;
    var timer;
    var _blob;
    var speaker = new SpeechSynthesisUtterance();
    export default {
        name: "ExerciseSimulation",
        data: () => {
            return {
                boardShow: false,
                isPlayingQuestion: false,
                isRecording: false, // 录音中
                showPlayer: false,  // 回放录音
                hasRecord: false,
                question: '',
                recordingTime: 0,
                stopTime: 0, // the time stopped
                allowed_post: true,
                limitTime: 5 * 60,
                chunkSend: false,
                submitted: false,
                file_url: undefined,  // blob
                judgeResult: undefined,

            }
        },
        mounted() {
            this.allowed_post = this.$route.query.ref == 'exam' ? true : false;
            this.initSpeaker();
        },
        computed: {
            recorderTimeText: function () {
                return this.formatTime(this.recordingTime);
            },
        },
        methods: {
            formatTime: function (time) {
                if (time > 60) {
                    let minutes = parseInt(time / 60);
                    let seconds = time % 60;
                    return minutes + ':' + seconds;
                } else {
                    return time < 10 ? '00:0' + time : '00:' + time;
                }
            },
            switchRecorderBoard: function () {
                // note ! audio must be created after user interaction
                this.boardShow = true;
                if (recorder == undefined) {
                    this.initRecorder();
                }
            },
            initSpeaker: function () {
                speaker.lang = 'zh';
                speaker.rate = 1.2;
                speaker.pitch = 1.5;
                speaker.onstart = () => {
                    this.isPlayingQuestion = true;
                }
                speaker.onend = () => {
                    this.isPlayingQuestion = false;
                }
            },
            initRecorder() {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                console.log('init audio', audioContext.state);
                recorder = new Recorder(audioContext, {
                    // An array of 255 Numbers
                    // You can use this to visualize the audio stream
                    // If you use react, check out react-wave-stream
                    onAnalysed: data => {
                        // console.log(data);
                        data;
                    }
                });
                navigator.mediaDevices.getUserMedia({audio: true})
                    .then(stream => {
                        recorder.init(stream);
                        console.log('recorder init successfully')
                    })
                    .catch(err => console.log('Uh oh... unable to get stream...', err));

            },
            startRecording: function () {
                return recorder.start().then(() => {
                    this.isRecording = true;
                    this.stopTime = 0;
                    this.recordingTime = 0;
                    timer = setInterval(() => {
                        this.recordingTime++;
                        if (this.recordingTime >= this.limitTime) {
                            this.stopRecording();
                        }
                    }, 1000)
                }).catch(err => {
                    console.log(err)
                });
            },
            stopRecording: function () {
                return recorder.stop()
                    .then(({blob, buffer,fileUrl}) => {
                        // blob:binary files;buffer: AudioBuffer;file_url
                        this.isRecording = false;
                        clearInterval(timer);
                        this.stopTime = this.recordingTime;
                        _blob = blob;
                        this.file_url = fileUrl;  //update file_url
                        console.log('stop recording', blob, buffer);
                    }).catch(err => {
                        console.log(err);
                    });
            },
            restartRecording: function () {
                if (this.isRecording) {
                    this.stopRecording().then(() => {
                        this.startRecording();
                    });
                }

            },
            replayRecording: function () {
                // 回答录音播放
                this.showPlayer = true;  // show video player
                var player = this.$refs.recorderPlayer;
                player.play();

            },
            // downloadRecording: function () {
            //     NewRecorder.download(_blob, 'my-audio-file'); // downloads a .wav file
            // },
            saveRecording: function () {
                this.hasRecord = true;
                this.boardShow = false;
                console.log('update file url');
                // this.$refs.recorderPlayer.src = URL.createObjectURL(_blob);
                this.$refs.recorderPlayer.src = this.file_url;
            },
            uploadRecording: function () {
                // file:size,name,is_chunk
                this.submitted = true;
                let res;
                if (this.chunkSend) {
                    let file = {name: 'recorder.wav', size: _blob.size, file: _blob}
                    res = this.chunkUpload(file);
                } else {
                    let formData = new FormData();
                    formData.set('file', _blob, 'recorder.wav')
                    res = this.$http.sendRecorder(formData);
                }
                res.then(data => {
                    data = data.data;
                    console.log('data:', data);
                    let judge = (data.judge == true ? '正确' : '错误');
                    console.log(judge, data.url);
                    this.judgeResult = judge;
                })
            },
            async chunkUpload(file) {
                // file {name,size,file} ,for chunk
                let chunkSize = 1024 * 1024;
                let chunks = Math.ceil(file.size / chunkSize);
                file.chunks = chunks; //
                for (let i = 0; i < chunks; i++) {
                    let fname_part = `${file.name}_part_${i + 1}`;
                    let end = (i + 1) * chunkSize <= file.size ? (i + 1) * chunkSize : file.size;
                    let file_part = file.file.slice(i * chunkSize, end)
                    let formData = new FormData();
                    formData.set('file', file_part, fname_part)
                    formData.set('is_chunk', true)
                    await this.$http.sendRecorder(formData)
                }
                return this.$http.mergeFile(file);
            },
            getQuestion: function () {
                this.$http.getQuestion().then(res => {
                    let question = res.data.text;
                    console.log(question);
                    this.question = question;
                    // cancel first
                    if (this.isPlayingQuestion) {
                        speechSynthesis.cancel();
                    }
                    speaker.text = this.question;
                    speechSynthesis.speak(speaker);
                })
            },
            playQuestion: function () {
                if (this.isPlayingQuestion) {
                    speechSynthesis.cancel();
                } else {
                    speaker.text = this.question;
                    speechSynthesis.speak(speaker);
                }


            }
        }
    }
</script>

<style lang="scss">
    @import "../files/模拟练习新/styles.css";

    .recorder-board {
        width: 600px;
        position: fixed;
        z-index: 100;
        left: 30%;
        top: 20%;
        background: white;
        border: 2px solid grey;

        .board-top {
            height: 20px;
            padding: 10px;
            color: #333333;
            background: rgba(242, 242, 242, 1);
            border-bottom: 1px solid grey;
            border-radius: 3px;
            font-family: '微软雅黑 Bold', '微软雅黑 Regular', '微软雅黑', sans-serif;
            font-weight: 700;
            font-style: normal;
            font-size: 16px;
            text-align: left;
            line-height: 20px;
            display: flex;
            justify-content: space-between;
        }

        .board-middle {
            border-bottom: 1px solid grey;
            padding: 65px 60px;

            .recorder-bar {
                height: 60px;
                padding: 0px 15px;
                border: 1px solid grey;
                border-radius: 5px;
                box-shadow: 1px 1px 1px #888888;
                display: flex;
                justify-content: space-around;
                align-items: center;

                .play {

                }

                .progress {
                    width: 270px;
                    margin-left: 15px;
                    margin-right: 20px;
                }
            }

        }

        .board-foot {
            height: 40px;
            padding: 30px 60px;
            display: flex;
            justify-content: space-around;

            .button {
                margin-right: 15px;
            }
        }
    }

    .judge-text {
        color: red;
        font-weight: bold;
        font-size: 16px;
    }

    .videoplayer {
        width: 250px;
        height: 50px;
        position: absolute;
        left: -30px;
        top: 50px
    }

    .question {
        width: 450px;
        position: absolute;
        left: 15px;
        top: 50px;
        font-weight: bold;
        font-size: 15px;
    }
</style>
